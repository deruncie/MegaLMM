<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Set MegaLMM run parameters — MegaLMM_control • MegaLMM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Set MegaLMM run parameters — MegaLMM_control"><meta property="og:description" content="Function to create run_parameters list for initializing MegaLMM model"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MegaLMM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MultiEnvironmentTrial.html">MultiEnvironmentTrial</a>
    </li>
    <li>
      <a href="../articles/Running_MegaLMM.html">Running MegaLMM</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Set MegaLMM run parameters</h1>
    
    <div class="hidden name"><code>MegaLMM_control.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to create run_parameters list for initializing MegaLMM model</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MegaLMM_control</span><span class="op">(</span></span>
<span>  which_sampler <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="fl">1</span>, F <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  run_sampler_times <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  scale_Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">F</span><span class="op">)</span>,</span>
<span>  K <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  h2_divisions <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  h2_step_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  drop0_tol <span class="op">=</span> <span class="fl">1e-14</span>,</span>
<span>  K_eigen_tol <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  burn <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max_NA_groups <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  svd_K <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save_current_state <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  diagonalize_ZtZ_Kinv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>which_sampler</dt>
<dd><p>List with two elements (Y and F) specifying which sampling function
to use for the observations (Y) and factors (F). Each is a number in 1-4. 1-3 are block updators. 4 is a single-site updater.
MegaLMM uses 1-3 depending on data dimensions.
MegaBayesC uses 4 which updates each coefficient individually.</p></dd>


<dt>run_sampler_times</dt>
<dd><p>For <code>which_sampler==4</code>, we can repeat the single-site sampler multiple times to help take larger steps each iteration.</p></dd>


<dt>scale_Y</dt>
<dd><p>Should the Y values be centered and scaled? Recommend, except for simulated data.</p></dd>


<dt>K</dt>
<dd><p>number of factors</p></dd>


<dt>h2_divisions</dt>
<dd><p>A scalar or vector of length equal to number of random effects. In MegaLMM, random
effects are parameterized as proportions of the total variance of all random effects plus residuals. 
The prior on the variance componets is discrete spanning the interval [0,1) over each varince component proportion
with <code>h2_divisions</code> equally spaced values is constructed. If
<code>h2_divisions</code> is a scalar, the prior for each variance component has this number of divisions. 
If a vector, the length should equal the number of variance components, in the order of the random effects specified in the model</p></dd>


<dt>h2_step_size</dt>
<dd><p>Either NULL, or a scaler in the range (0,1].
If NULL, h2's will be sampled based on the marginal probability over all possible h2 vectors. 
If a scalar, a Metropolis-Hastings update step will be used for each h2 vector.
The trail value will be selected uniformly from all possible h2 vectors within this Euclidean distance from the current vector.</p></dd>


<dt>drop0_tol</dt>
<dd><p>A scalar giving the a tolerance for the <code>drop0()</code> function that will be applied
to various symmetric (possibly) sparse matrices to try to fix numerical errors and increase sparsity.</p></dd>


<dt>K_eigen_tol</dt>
<dd><p>A scalar giving the minimum eigenvalue of a K matrix allowed. During pre-processing,
eigenvalues of each K matrix will be calculated using <code>svd(K)</code>. Only eigenvectors of K with corresponding eigenvalues
greater than this value will be kept. If smaller eigenvalues exist, the model will be transformed
to reduce the rank of K, by multiplying Z by the remaining eigenvectors of K. This transformation
is undone before posterior samples are recorded, so posterior samples of <code>U_F</code> and <code>U_R</code> are
untransformed.</p></dd>


<dt>burn</dt>
<dd><p>burnin length of the MCMC chain</p></dd>


<dt>thin</dt>
<dd><p>thinning rate of the MCMC chain</p></dd>


<dt>max_NA_groups</dt>
<dd><p>If 0, all NAs will be imputed during sampling. If Inf, all NAs will be marginalized over.
If in (0,Inf), up to this many groups of columns will be separately sampled.
The minimum number of NAs in each column not in one of these groups will be imputed.</p></dd>


<dt>svd_K</dt>
<dd><p>If TRUE, the the diagonalization of ZKZt for the first random effect is accomplished using this algorithm:
https://math.stackexchange.com/questions/67231/singular-value-decomposition-of-product-of-matrices which doesn't require forming ZKTt.
If FALSE, the SVD of ZKZt for the first random effect is calculated directly. TRUE is generally faster if the same genomes are repeated several times.</p></dd>


<dt>verbose</dt>
<dd><p>should progress during initiation and sampling be printed?</p></dd>


<dt>save_current_state</dt>
<dd><p>should the current state of the sampler be saved every time the function <code>sample_MegaLMM</code> is called?</p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>MegaLMM_init</code>, <code><a href="sample_MegaLMM.html">sample_MegaLMM</a></code>, <code><a href="print.MegaLMM_state.html">print.MegaLMM_state</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel E Runcie.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

